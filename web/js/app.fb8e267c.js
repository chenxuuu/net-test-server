(function(t){function e(e){for(var s,o,c=e[0],r=e[1],l=e[2],d=0,h=[];d<c.length;d++)o=c[d],Object.prototype.hasOwnProperty.call(a,o)&&a[o]&&h.push(a[o][0]),a[o]=0;for(s in r)Object.prototype.hasOwnProperty.call(r,s)&&(t[s]=r[s]);u&&u(e);while(h.length)h.shift()();return i.push.apply(i,l||[]),n()}function n(){for(var t,e=0;e<i.length;e++){for(var n=i[e],s=!0,c=1;c<n.length;c++){var r=n[c];0!==a[r]&&(s=!1)}s&&(i.splice(e--,1),t=o(o.s=n[0]))}return t}var s={},a={app:0},i=[];function o(e){if(s[e])return s[e].exports;var n=s[e]={i:e,l:!1,exports:{}};return t[e].call(n.exports,n,n.exports,o),n.l=!0,n.exports}o.m=t,o.c=s,o.d=function(t,e,n){o.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},o.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},o.t=function(t,e){if(1&e&&(t=o(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(o.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var s in t)o.d(n,s,function(e){return t[e]}.bind(null,s));return n},o.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return o.d(e,"a",e),e},o.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},o.p="/";var c=window["webpackJsonp"]=window["webpackJsonp"]||[],r=c.push.bind(c);c.push=e,c=c.slice();for(var l=0;l<c.length;l++)e(c[l]);var u=r;i.push([0,"chunk-vendors"]),n()})({0:function(t,e,n){t.exports=n("56d7")},"40d7":function(t,e,n){},"56d7":function(t,e,n){"use strict";n.r(e);n("e260"),n("e6cf"),n("cca6"),n("a79d");var s=n("7a23");function a(t,e,n,a,i,o){var c=Object(s["l"])("WstMain");return Object(s["h"])(),Object(s["d"])(c)}n("8d59");var i=Object(s["o"])("data-v-05fd872f");Object(s["j"])("data-v-05fd872f");var o={key:0},c={key:1},r=Object(s["g"])("i",{class:"fas fa-heartbeat"},null,-1),l=Object(s["g"])("i",{class:"fas fa-tools"},null,-1),u=Object(s["g"])("i",{class:"fas fa-bug"},null,-1),d={key:0,class:"as-error"},h={key:0},f={class:"as-info"},b={key:0,class:"fas fa-caret-right current-dot"},p=Object(s["g"])("i",{class:"fas fa-wifi"},null,-1),O={key:2,class:"fas fa-wifi"},m={key:3,class:"fas fa-plug"},y={class:"as-tip"},g={class:"as-client-id"},j={class:"as-addr-port"},C={key:1},w={class:"as-clr"},S={ref:"log"},v={key:0,class:"fas fa-satellite-dish"},x={key:1,class:"far fa-paper-plane"},k={key:2},L={class:"as-dis"},H={key:3,class:"as-hex"},E=Object(s["g"])("i",{class:"fas fa-retweet"},null,-1);Object(s["i"])();var D=i((function(t,e,n,a,D,T){return Object(s["h"])(),Object(s["d"])("div",{class:["wstool",T.TopClass]},[Object(s["g"])("header",null,[Object(s["g"])("h1",null,[Object(s["f"])(Object(s["m"])(t.i18n["wst-title"])+" ",1),t.myClientPort>0?(Object(s["h"])(),Object(s["d"])("em",o,"152.70.80.204:"+Object(s["m"])(t.myClientPort)+" / [2603:c023:1:5fcc:c028:8ed:49a7:6e08]:"+Object(s["m"])(t.myClientPort)+"（根据你开的是v4还是v6）",1)):Object(s["e"])("",!0),t.myLastHB?(Object(s["h"])(),Object(s["d"])("u",c,[r,Object(s["f"])(" "+Object(s["m"])(t.myLastHB),1)])):Object(s["e"])("",!0)]),Object(s["g"])("aside",null,[Object(s["g"])("a",{target:"_blank",href:"https://github.com/chenxuuu/llcom","data-balloon-pos":"down-right","aria-label":t.i18n["wst-llcom-tip"]},[l,Object(s["f"])(Object(s["m"])(t.i18n["wst-llcom-text"]),1)],8,["aria-label"]),Object(s["g"])("i",{class:T.ConnectIcon},null,2),T.isClosed?(Object(s["h"])(),Object(s["d"])(s["a"],{key:0},[Object(s["g"])("button",{onClick:e[1]||(e[1]=function(t){return T.OnClickConnect("tcp")})},Object(s["m"])(t.i18n["wst-connect-tcp"]),1),Object(s["g"])("button",{onClick:e[2]||(e[2]=function(t){return T.OnClickConnect("udp")})},Object(s["m"])(t.i18n["wst-connect-udp"]),1),Object(s["g"])("button",{onClick:e[3]||(e[3]=function(t){return T.OnClickConnect("ssl-tcp")})},Object(s["m"])(t.i18n["wst-connect-tcp-ssl"]),1)],64)):(Object(s["h"])(),Object(s["d"])("button",{key:1,onClick:e[4]||(e[4]=function(){return T.OnClickClosed.apply(T,arguments)})},Object(s["m"])(t.i18n["wst-connect-close"]),1)),Object(s["g"])("a",{target:"_blank",href:"https://github.com/chenxuuu/net-test-server/issues","data-balloon-pos":"down-right","aria-label":t.i18n["wst-bug-tip"]},[u,Object(s["f"])(Object(s["m"])(t.i18n["wst-bug-text"]),1)],8,["aria-label"])])]),T.isError?(Object(s["h"])(),Object(s["d"])("pre",d,Object(s["m"])(t.myErrMsg),1)):Object(s["e"])("",!0),Object(s["g"])("section",null,[Object(s["g"])("nav",null,[T.hasClients?(Object(s["h"])(),Object(s["d"])("ul",h,[(Object(s["h"])(!0),Object(s["d"])(s["a"],null,Object(s["k"])(T.TheClientList,(function(e){return Object(s["h"])(),Object(s["d"])("li",{key:e.clientId,class:e.className,onClick:Object(s["n"])((function(n){return t.myCurrentClientId=e.clientId}),["left"])},[Object(s["g"])("div",f,[e.current?(Object(s["h"])(),Object(s["d"])("i",b)):Object(s["e"])("",!0),e.connected&&e.current?(Object(s["h"])(),Object(s["d"])("span",{key:1,"data-balloon-pos":"right","aria-label":t.i18n["wst-client-close-tip"],onClick:Object(s["n"])((function(t){return T.OnCloseClient(e)}),["left"])},[p],8,["aria-label","onClick"])):e.connected?(Object(s["h"])(),Object(s["d"])("i",O)):(Object(s["h"])(),Object(s["d"])("i",m)),Object(s["f"])(" "+Object(s["m"])(e.addrHost),1)]),Object(s["g"])("div",y,[Object(s["g"])("code",g,Object(s["m"])(e.clientId),1),Object(s["g"])("code",j,Object(s["m"])(e.addrPort),1)])],10,["onClick"])})),128))])):(Object(s["h"])(),Object(s["d"])("blockquote",C,Object(s["m"])(t.i18n["wst-client-empty"]),1))]),Object(s["g"])("main",null,[Object(s["g"])("header",null,[Object(s["g"])("div",{class:"as-hex","data-balloon-pos":"up-left","aria-label":T.UseHexTip,onClick:e[5]||(e[5]=Object(s["n"])((function(e){return t.myUseHex=!t.myUseHex}),["left"]))},"HEX",8,["aria-label"]),Object(s["g"])("input",{placeholder:t.i18n["wst-send-tip"],spellcheck:"fase",ref:"input",readonly:!T.isCanSendData,onChange:e[6]||(e[6]=function(){return T.OnSendMsg.apply(T,arguments)})},null,40,["placeholder","readonly"]),Object(s["g"])("div",{class:"as-nl","data-balloon-pos":"up-right","aria-label":T.UseNLTip,onClick:e[7]||(e[7]=Object(s["n"])((function(e){return t.myUseNL=!t.myUseNL}),["left"]))},"NL",8,["aria-label"]),Object(s["g"])("div",w,[Object(s["g"])("a",{onClick:e[8]||(e[8]=Object(s["n"])((function(){return T.ClearLog.apply(T,arguments)}),["left"]))},"CLR")])]),Object(s["g"])("blockquote",S,[Object(s["g"])(s["b"],{name:"list",tag:"div"},{default:i((function(){return[(Object(s["h"])(!0),Object(s["d"])(s["a"],null,Object(s["k"])(T.CurrentClientData,(function(e){return Object(s["h"])(),Object(s["d"])("p",{key:e.ams,class:"as-type-".concat(e.type)},[Object(s["g"])("em",null,"["+Object(s["m"])(e.time)+"]",1),"IN"==e.type?(Object(s["h"])(),Object(s["d"])("i",v)):(Object(s["h"])(),Object(s["d"])("i",x)),e.hex?(Object(s["h"])(),Object(s["d"])("u",k,"HEX")):Object(s["e"])("",!0),Object(s["g"])("span",L,Object(s["m"])(e.strDisplay),1),t.myShowLineHex?(Object(s["h"])(),Object(s["d"])("span",H,Object(s["m"])(e.hexCode),1)):Object(s["e"])("",!0)],2)})),128))]})),_:1})],512),Object(s["g"])("footer",null,[Object(s["g"])("div",{class:["log-order",{"is-desc":"DESC"==t.myLogOrder}],"data-balloon-pos":"up","aria-label":T.LogOrderTip,onClick:e[9]||(e[9]=Object(s["n"])((function(e){return t.myLogOrder="ASC"==t.myLogOrder?"DESC":"ASC"}),["left"]))},[Object(s["g"])("i",{class:T.LogOrderIcon},null,2)],10,["aria-label"]),Object(s["g"])("div",{class:["echo-back",{"is-on":t.myEchoBack}],"data-balloon-pos":"left","data-balloon-length":"medium","aria-label":T.EchoBackTip,onClick:e[10]||(e[10]=Object(s["n"])((function(e){return t.myEchoBack=!t.myEchoBack}),["left"]))},[E],10,["aria-label"]),Object(s["g"])("div",{class:["show-hex",{"is-on":t.myShowLineHex}],"data-balloon-pos":"right","aria-label":T.ShowLineHexTip,onClick:e[11]||(e[11]=Object(s["n"])((function(e){return t.myShowLineHex=!t.myShowLineHex}),["left"]))},"HEX",10,["aria-label"])])])])],2)})),T=(n("4160"),n("a434"),n("ac1f"),n("498a"),n("159b"),n("99af"),n("a15b"),n("d3b7"),n("25f0"),n("4d90"),n("2ef0")),I=n.n(T),B={connect:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.host,n=t.onopen,s=t.onmessage,a=t.onclose,i=t.onerror,o={"http:":"ws","https:":"wss"}[window.location.protocol],c="".concat(o,":").concat(e);console.log(c);var r=new WebSocket(c);return r.onopen=n,r.onmessage=s,r.onclose=a,r.onerror=i,r},decodeUtf8:function(t){for(var e="",n=0;n<t.length;n+=2)e+="%"+t[n]+t[n+1];return decodeURIComponent(e)},encodeUtf8:function(t){for(var e=[],n=0;n<t.length;n++){var s=t.charCodeAt(n),a=I.a.padStart(s.toString(16).toUpperCase(),2,"0");e.push(a)}return e.join("")},formatDate:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"yyyy-MM-dd HH:mm:ss.SSS";if(I.a.isDate(t)||(t=new Date(t)),!t)return null;var n,s=t.getFullYear(),a=t.getMonth()+1,i=t.getDate(),o=t.getHours(),c=t.getMinutes(),r=t.getSeconds(),l=t.getMilliseconds(),u={yyyy:s,M:a,d:i,H:o,m:c,s:r,S:l,yyy:s,yy:(""+s).substring(2,4),MM:I.a.padStart(a,2,"0"),dd:I.a.padStart(i,2,"0"),HH:I.a.padStart(o,2,"0"),mm:I.a.padStart(c,2,"0"),ss:I.a.padStart(r,2,"0"),SS:I.a.padStart(l,3,"0"),SSS:I.a.padStart(l,3,"0")},d=/(y{2,4}|M{1,4}|dd?|HH?|mm?|ss?|S{1,3}|E{1,4}|'([^']+)')/g,h=[],f=0;n=d.exec(e);while(n){f<n.index&&h.push(e.substring(f,n.index));var b=n[2]||u[n[1]]||n[1];h.push(b),f=d.lastIndex,n=d.exec(e)}return f<e.length&&h.push(e.substring(f)),h.join("")}},U={"wst-title":"LuatOS 网络测试工具（海外服务器版本）","wst-llcom-text":"串口助手llcom","wst-llcom-tip":"可运行lua脚本的高自由度串口调试工具🛠。","wst-connect-tcp":"打开 TCP（ipv4）","wst-connect-udp":"打开 TCP（ipv6）","wst-connect-tcp-ssl":"（待定）","wst-connect-close":"断开连接","wst-bug-tip":"使用中遇到任何🕷️问题🕷️，就尽情给我们反馈吧 😺","wst-bug-text":"反馈问题","wst-client-close-tip":"点击断开客户端连接","wst-client-empty":"未侦测到连接的设备","wst-send-tip":"发送消息","wst-use-hex-on-tip":"消息内容为16进制编码","wst-use-hex-off-tip":"消息内容为纯文本","wst-use-nl-on-tip":"自动为消息添加换行符 \\r\\n","wst-use-nl-off-tip":"点击后，会自动为消息添加换行符 \\r\\n","wst-use-eb-on-tip":"收到客户端消息后，自动回显","wst-use-eb-off-tip":"点击后，将打开自动回显","wst-show-hex-on-tip":"日志面板同时显示16进制编码消息，点击即可隐藏它们","wst-show-hex-off-tip":"点击后，日志面板会同时显示16进制编码消息","wst-log-asc-tip":"日志行按照从早到晚顺序排列","wst-log-desc-tip":"日志行按照从晚到早顺序排列"},N={name:"WstMain",data:function(){return{i18n:U,HBI:void 0,myLastHB:void 0,myStat:"CLOSED",myUseHex:!1,myUseNL:!1,myEchoBack:!1,myLogOrder:"ASC",myShowLineHex:!0,myClientPort:void 0,myErrMsg:void 0,myClients:{},myCurrentClientId:void 0,myDataSet:{}}},props:{wsHost:{type:String,default:"//netlab.luatos.org/ws/netlab"}},computed:{TopClass:function(){return{"use-hex":this.myUseHex,"use-nl":this.myUseNL}},ConnectIcon:function(){return{CONNECTED:"fas fa-signal",CLOSED:"fab fa-deezer",ERROR:"fas fa-exclamation-triangle"}[this.myStat]},isConnected:function(){return"CONNECTED"==this.myStat},isClosed:function(){return"CLOSED"==this.myStat},isError:function(){return"ERROR"==this.myStat},hasClients:function(){return!I.a.isEmpty(this.TheClientList)},isCanSendData:function(){return!!this.myCurrentClientId&&this.isConnected},UseHexTip:function(){return this.myUseHex?this.i18n["wst-use-hex-on-tip"]:this.i18n["wst-use-hex-off-tip"]},UseNLTip:function(){return this.myUseNL?this.i18n["wst-use-nl-on-tip"]:this.i18n["wst-use-nl-off-tip"]},EchoBackTip:function(){return this.myEchoBack?this.i18n["wst-use-eb-on-tip"]:this.i18n["wst-use-eb-off-tip"]},ShowLineHexTip:function(){return this.myShowLineHex?this.i18n["wst-show-hex-on-tip"]:this.i18n["wst-show-hex-off-tip"]},LogOrderIcon:function(){return"ASC"==this.myLogOrder?"fas fa-sort-amount-down-alt":"fas fa-sort-amount-up"},LogOrderTip:function(){return"ASC"==this.myLogOrder?this.i18n["wst-log-asc-tip"]:this.i18n["wst-log-desc-tip"]},TheClientList:function(){var t=this,e=[];return I.a.forEach(this.myClients,(function(n){var s=I.a.cloneDeep(n),a=/\/?([^:]+)(:(\d+))?/.exec(s.addr);a&&(s.addrHost=I.a.trim(a[1]),s.addrPort=I.a.trim(a[3])),s.data=I.a.get(t.myDataSet,n.clientId)||[],s.current=t.myCurrentClientId==n.clientId,s.className={"is-current":s.current,"is-connected":s.connected},e.splice(0,0,s)})),e},CurrentClientData:function(){return I.a.get(this.myDataSet,this.myCurrentClientId)||[]}},methods:{OnCloseClient:function(t){var e=t.clientId;this.send({action:"closec",client:e})},OnSendMsg:function(){if(this.isCanSendData){var t=I.a.trim(this.$refs.input.value);if(t){this.myUseNL&&(this.myUseHex?t+="0D0A":t+="\r\n");var e={action:"sendc",data:t,hex:this.myUseHex,client:this.myCurrentClientId};this.send(e),this.pushToCurrentData({type:"OUT",client:this.myCurrentClientId,data:t,hex:this.myUseHex}),this.$refs.input.value=null}}},OnClickClosed:function(){console.log("hahah"),this.isConnected&&this.$WEBS.close()},ClearLog:function(){this.myCurrentClientId&&(this.myDataSet[this.myCurrentClientId]=[])},send:function(t){if(this.isConnected){var e=t;I.a.isString(t)||(e=JSON.stringify(t)),console.log(">> send: ",e),this.$WEBS.send(e)}else console.log("未连接，不能发消息！")},OnClickConnect:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"tcp";this.isCanMakeNewWebSocketObj()&&(this.$WEBS=B.connect({host:this.wsHost,onopen:function(n){console.log("ws:open:",n),t.myStat="CONNECTED",t.send({action:"newp",type:e}),t.startHeartBeat()},onmessage:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.data,s=JSON.parse(n);console.log("ws:msg:",s),t.dispatchAction(s)},onclose:function(e){console.warn("ws:close:",e),t.$WEBS=void 0,t.myStat="CLOSED",t.myClientPort=void 0,t.stopHeartBeat()},onerror:function(e){console.error("ws:error:",e),t.myStat="ERROR"}}))},dispatchAction:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.action,s={port:function(e){var n=e.port;t.myClientPort=n},connected:function(e){var n=e.client,s=e.addr;I.a.set(t.myClients,n,{clientId:n,addr:s,connected:!0}),t.myCurrentClientId=n},closed:function(e){var n=e.client;I.a.set(t.myClients,"".concat(n,".connected"),!1)},data:function(e){var n=e.client,s=e.data,a=e.hex;if(t.pushToCurrentData({type:"IN",client:n,data:s,hex:a}),t.myEchoBack){var i={action:"sendc",data:s,hex:a,client:n};t.send(i),t.pushToCurrentData({type:"OUT",client:n,data:s,hex:a})}},error:function(e){var n=e.msg;t.myErrMsg=n}}[n];I.a.isFunction(s)&&s.apply(this,[e])},pushToCurrentData:function(t){var e,n,s=this,a=t.type,i=void 0===a?"IN":a,o=t.client,c=t.data,r=t.hex,l=I.a.get(this.myDataSet,o);if(I.a.isArray(l)||(l=[],this.myDataSet[o]=l),r){n=c;try{e=B.decodeUtf8(c),r=!1}catch(m){console.warn("Fail to decodeUtf8",c)}}else e=c,n=B.encodeUtf8(c);var u=/((.+)|(\r?\n))/g,d="";if(e){var h=u.exec(e);while(h){var f=h[2],b=h[3];f?d+=f:b&&(d+="⬅️\n"),h=u.exec(e)}}var p=new Date,O={type:i,ams:p.getTime(),time:B.formatDate(p),raw:c,hex:r,str:e,hexCode:n,strDisplay:d};"ASC"==this.myLogOrder?l.push(O):l.splice(0,0,O),"ASC"==this.myLogOrder&&this.$nextTick((function(){s.scrollLogToBottom()}))},sortLogData:function(){var t=this;I.a.forEach(this.myDataSet,(function(e,n){I.a.isEmpty(e)||("ASC"==t.myLogOrder?e.sort((function(t,e){return t.ams-e.ams})):e.sort((function(t,e){return e.ams-t.ams})))}))},scrollLogToBottom:function(){var t=this.$refs.log;I.a.isElement(t)&&(t.scrollTop=t.scrollHeight)},isCanMakeNewWebSocketObj:function(){if(!this.$WEBS)return!0;var t=this.$WEBS.readyState;return 0==t?(alert("正在建立连接中，请稍候 ..."),!1):1==t?(alert("连接已建立，不能重复连接！"),!1):2==t?(alert("正在关闭连接中，请稍候 ..."),!1):(3==t&&(this.$WEBS=void 0),!0)},saveSettings:function(){var t=JSON.stringify({useHex:this.myUseHex,useNL:this.myUseNL,showLineHex:this.myShowLineHex,echoBack:this.myEchoBack,logOrder:this.myLogOrder});localStorage.setItem("LUATOS_WST_SETTINGS",t)},startHeartBeat:function(){var t=this;this.HBI=window.setInterval((function(){t.myLastHB=B.formatDate(new Date),t.send({})}),3e4)},stopHeartBeat:function(){this.HBI&&(window.clearInterval(this.HBI),this.HBI=null)}},watch:{myUseHex:"saveSettings",myUseNL:"saveSettings",myShowLineHex:"saveSettings",myEchoBack:"saveSettings",myLogOrder:function(){this.saveSettings(),this.sortLogData()}},mounted:function(){var t=localStorage.getItem("LUATOS_WST_SETTINGS")||"{}",e=JSON.parse(t);I.a.defaults(e,{useHex:!1,useNL:!1,showLineHex:!0,echoBack:!1,logOrder:"ASC"}),this.myUseHex=e.useHex,this.myUseNL=e.useNL,this.myShowLineHex=e.showLineHex,this.myEchoBack=e.echoBack,this.myLogOrder=e.logOrder},beforeDestroied:function(){this.OnClickClosed()}};n("58a4");N.render=D,N.__scopeId="data-v-05fd872f";var M=N,A={name:"App",components:{WstMain:M}};n("64be");A.render=a;var P=A;n("68c8"),n("15f5");Object(s["c"])(P).mount("#app")},"58a4":function(t,e,n){"use strict";n("40d7")},"64be":function(t,e,n){"use strict";n("c894")},"8d59":function(t,e,n){},c894:function(t,e,n){}});
//# sourceMappingURL=app.fb8e267c.js.map
